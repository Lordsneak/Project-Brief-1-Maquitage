/* Copyright Codetipi - Fotomag 1.4.3 */
/* globals jQuery, fotomagScripts, YT */
function onYouTubeIframeAPIReady(){CbYTPlayer.length>0&&(cbYTPlayerHolder=new YT.Player("cb-yt-player-"+cbEmbedIconData,{videoId:cbYouTubeVideoID}))}!function(e){"use strict";function a(){_=W===!0?F>781?z.scrollTop()+32:z.scrollTop()+46:z.scrollTop(),t()}function t(){O||(requestAnimationFrame(s),O=!0)}function s(){if(F>767?Ce.visible(!0)?(R.addClass("cb-sides-freeze"),re.css({top:Ce.offset().top-U}),de.css({top:Ce.offset().top-U})):(R.removeClass("cb-sides-freeze"),de.css({top:"0"}),re.css({top:"0"})):ye.length?_>M?R.addClass("cb-mob-freeze"):R.removeClass("cb-mob-freeze"):_>N?R.addClass("cb-mob-freeze"):R.removeClass("cb-mob-freeze"),(R.hasClass("single")||R.hasClass("page"))&&(re.length||de.length?F>767&&xe.length&&!Ce.visible(!0)?(xe.each(function(){e(this).visible(!0)&&(I=!0)}),I===!0?R.removeClass("cb-show-sides"):R.addClass("cb-show-sides"),I=!1):R.addClass("cb-show-sides"):R.removeClass("cb-show-sides")),0!==Te.length&&we.hasClass("cb-style-1"))if(_<U){R.removeClass("cb-par-hidden"),W===!0&&(_-=32);var a=_/2,t=a+"px";Te.css({"-webkit-transform":"translate3d(0, "+t+", 0)",transform:"translate3d(0, "+t+", 0)"})}else R.addClass("cb-par-hidden");if(ke.length&&(j=pe.height(),E=2*M+j,A=parseFloat(100-(_-M)/(E-2*M)*100).toFixed(2),i(A)),e(".cb-blog-infinite-scroll").length){var s=e(".cb-blog-infinite-scroll").parent().prev();s.visible(!0)&&o(e(".cb-blog-infinite-scroll a"))}O=!1}function o(a){Pe!==!0&&(Pe=!0,P=a,k=P.attr("href"),v=P.parent().data("cb-prev"),C=P.parent().data("cb-next"),T=P.parent().parent(),R.addClass("cb-il-loading"),m=T.prev(),m.attr("data-cb-prev",v),m.attr("data-cb-next",C),e.get(k,function(a){w=e(a).find("#cb-main"),w.children().addClass("cb-slide-up-opa"),R.hasClass("cb-body-bs-2")?(w.find(".cb-m").removeClass("cb-m").addClass("cb-s"),w=w.children()):w=w.children(),e("#cb-main").append(w),"undefined"!=typeof De&&null!==De&&De.push(["_trackPageview",k]),new ScrollMagic.Scene({triggerElement:m,triggerHook:"onLeave"}).addTo(Ae).on("enter leave",function(a){"leave"===a.type?window.history.pushState("","",e("#"+this.triggerElement().id).data("cb-prev")):window.history.pushState("","",e("#"+this.triggerElement().id).data("cb-next"))}),R.removeClass("cb-il-loading"),T.remove(),Pe=!1}))}function i(e){e<0||e>100?R.removeClass("cb-read-live"):(Se.length&&Se.text(100-Math.round(e)+"%"),ke.find(".cb-bar").css({"-webkit-transform":"translateX(-"+e+"%)",transform:"translateX(-"+e+"%)"}),R.addClass("cb-read-live"))}function c(){e.ajax({method:"GET",data:{action:"fotomag_al_l",fotomagPostId:fotomagScripts.fotomagPostId,fotomagCounter:Ee},url:fotomagScripts.fotomagUrl,beforeSend:function(){},success:function(a){return 0===a.length?void Me.addClass("cb-no-more"):(e("#cb-main").append(a),e("#cb-al-post-"+Ee).addClass("cb-loaded"),e("#cb-al").removeClass("cb-running").appendTo("#cb-al-post-"+Ee+" #cb-entry-content"),h(e("#cb-al-post-"+Ee+" #cb-entry-content .alignnone")),xe=xe.add(e("#cb-al-post-"+Ee+" #cb-fis-wrap.cb-hide-bars")),e("#cb-al-post-"+Ee+" #cb-fis-gallery").length&&(e("#cb-al-post-"+Ee+" #cb-fis-gallery").slick({variableWidth:!0,centerMode:!1,prevArrow:'<i class="fa cb-slider-arrow cb-slider-arrow-p fa-angle-left"></i>',nextArrow:'<i class="fa cb-slider-arrow cb-slider-arrow-n fa-angle-right"></i>'}),e("#cb-al-post-"+Ee+" #cb-fis-gallery").find(".slick-track").children().addClass("cb-slider-ldd").removeClass("cb-slider-hidden")),e("#cb-al-post-"+Ee+" #cb-fis").on("click",".cb-embed-icon",function(a){a.preventDefault(),x=e(this).data("cb-pid"),e("#cb-media-trigger-"+x).addClass("cb-active"),R.addClass("cb-pf-modal-on")}),pe=e("#cb-al-post-"+Ee+" #cb-entry-content"),S=e("#cb-al-post-"+Ee).data("cb-purl"),l(e("#cb-al-post-"+Ee)),M=e("#cb-al-post-"+Ee+" #cb-entry-content").offset().top,"undefined"!=typeof De&&null!==De&&De.push(["_trackPageview",S]),e.ajax({url:fotomagScripts.fotomagPlURL+"/jetpack/modules/tiled-gallery/tiled-gallery/tiled-gallery.js",type:"HEAD",success:function(){e.getScript(fotomagScripts.fotomagPlURL+"/jetpack/modules/tiled-gallery/tiled-gallery/tiled-gallery.js")}}),e.ajax({url:fotomagScripts.fotomagPlURL+"/aesop-story-engine/public/assets/js/ai-core.min.js",type:"HEAD",success:function(){e.getScript(fotomagScripts.fotomagPlURL+"/aesop-story-engine/public/assets/js/ai-core.min.js")}}),void Ee++)},error:function(e,a,t){console.log("cbsa "+e+" :: "+a+" :: "+t)}})}function l(e){Ie.update(),Me.removeClass("cb-running"),new ScrollMagic.Scene({triggerElement:e}).addTo(_e).on("enter leave",function(a){n(e,a.type)})}function n(e,a){var t;"leave"==a?(t=e.prev().data("cb-purl"),"undefined"!=typeof t&&window.history.pushState("","",t)):window.history.pushState("","",e.data("cb-purl"))}function r(){var a=se.val();return 0===a.length&&oe.empty(),a.length<3?void se.removeClass("cb-slide-up"):void e.ajax({method:"GET",data:{action:"fotomag_s_a",fotomagI:a},url:fotomagScripts.fotomagUrl,beforeSend:function(){oe.removeClass("cb-slide-down"),te.addClass("cb-loading")},success:function(a){te.addClass("cb-padded"),oe.html(e(a)),oe.addClass("cb-slide-down"),se.addClass("cb-slide-up")},error:function(e,a,t){console.log("cbsa "+e+" :: "+a+" :: "+t)}})}function d(){R.removeClass("cb-s-modal-on")}function b(){R.removeClass("cb-m-modal-on")}function f(){R.removeClass("cb-sub-modal-on")}function g(){R.removeClass("cb-pf-modal-on"),e('[id^="cb-media-trigger-"]').removeClass("cb-active")}function h(e){if(R.hasClass("cb-fw-embeds"))if(e.hasClass("wp-caption")){var a=e.find("img");a.hasClass("size-full")&&(e.addClass("cb-hide-bars cb-fs-img"),a.addClass("cb-vw-img"),xe=xe.add(e),X===!0?e.css({"margin-right":pe.width()/2-F/2,"max-width":"none"}).addClass("cb-fs-embed"):e.css({"margin-left":pe.width()/2-F/2,"max-width":"none"}).addClass("cb-fs-embed"),e.add(a).css("width",F))}else e.hasClass("size-full")&&(e.addClass("cb-hide-bars cb-fs-img cb-vw-img"),xe=xe.add(e),X===!0?e.css({"margin-right":pe.width()/2-F/2,"max-width":"none",width:F}):e.css({"margin-left":pe.width()/2-F/2,"max-width":"none",width:F}))}function p(){B===!1&&Ye.length>0&&cbYTPlayerHolder.playVideo()}function u(){B===!1&&Ye.length>0&&cbYTPlayerHolder.pauseVideo()}var m,v,C,y,w,k,x,S,T,P,D,j,E,A,M,_,I,Y,H=e("#cb-to-top"),z=e(window),L=e(document),U=z.height()+1,F=z.width(),R=e("body"),V=e(".cb-modal-closer"),G=e("#cb-header"),N=G.outerHeight(),Q=e("html, body"),B=!1,O=!1,W=!1,X=!1,q=e("#cb-menu-closer"),J=e("#cb-sub-closer"),K=e("#cb-overlay").add(q).add(J),Z=e("#cb-search-trigger"),$=e("#cb-menu-trigger"),ee=e("#cb-sub-trigger"),ae=[9,13,16,17,18,20,32,45,116],te=e("#cb-search-overlay"),se=te.find(".cb-search-field"),oe=te.find("#cb-s-results"),ie=0,ce=e("#cb-fis-gallery"),le=e("#cb-embed-icon-trigger"),ne=le.data("cb-pid"),re=e("#cb-nav-left"),de=e("#cb-nav-right"),be=e(".cb-tip-bot"),fe=e(".cb-tip-right"),ge=e("#cb-slide-in-nav"),he=ge.find("> .menu-item-has-children"),pe=e("#cb-entry-content"),ue=pe.find('iframe[src*="vimeo"], iframe[src*="youtube.com"]'),me=pe.find(".alignnone"),ve=e("#cb-vertical-down"),Ce=e("#cb-footer"),ye=e("#cb-fis-wrap"),we=e("#cb-fis"),ke=e("#cb-read-progress"),xe=e(".cb-hide-bars"),Se=e("#cb-progress-value"),Te=we.find(".cb-fis-bg"),Pe=!1,De=De||[],je=0,Ee=0,Ae=new ScrollMagic.Controller;if((R.hasClass("cb-body-tabl")||R.hasClass("cb-body-mob"))&&(B=!0),Ce.length&&(y=Ce.offset().top),Te.imagesLoaded({background:!0},function(){Te.addClass("cb-fis-bg-ldd")}),ye.length&&(we.hasClass("cb-style-1")?(ye.css("height",U-N),we.css("height",U),R.hasClass("page")&&we.css("max-height",N+parseFloat(we.css("max-height"))+"px")):we.hasClass("cb-style-2")&&ye.css("height",Math.round((U-N)/1.4))),pe.length&&(M=pe.offset().top,ue.each(function(){e(this).wrap('<div class="cb-embed-wrap"></div>')})),R.hasClass("rtl")&&(X=!0),R.hasClass("admin-bar")&&(W=!0),e("#cb-main").on("click",".cb-like-it",function(a){if(a.preventDefault(),!e(this).hasClass("cb-lkd")){var t=e(this),s=t.data("cb-pid"),o=t.data("cb-nonce");t=t.add(".cb-like-it-"+s),e.ajax({type:"POST",data:{action:"fotomag_a_l",fotomagAlNonce:o,fotomagPostId:s},url:fotomagScripts.fotomagUrl,dataType:"json",beforeSend:function(){t.addClass("cb-loading")},success:function(a){Cookies.set("article_liked",a[1],{expires:14}),"-1"!==a[0]&&"null"!==a[0]&&e(".cb-like-it-"+s+" .cb-likes-int").html(a[0]),t.addClass("cb-lkd"),t.removeClass("cb-lkd-0")},error:function(e,a,t){console.log("fotomag_Al_ "+e+" :: "+a+" :: "+t)}})}}),ve.click(function(e){e.preventDefault(),pe.length&&Q.animate({scrollTop:M+1},1200)}),V.click(function(e){e.preventDefault()}),window.addEventListener("scroll",a,!1),e("#cb-alp-loader").length)var Me=e("#cb-alp-loader"),_e=new ScrollMagic.Controller,Ie=new ScrollMagic.Scene({triggerElement:Me,offset:-800}).addTo(_e).on("enter",function(e){Me.hasClass("cb-running")||(Me.addClass("cb-running"),c())});L.on("click",".cb-blog-infinite-load a",function(a){a.preventDefault(),Pe!==!0&&(Pe=!0,P=e(this),k=e(this).attr("href"),v=e(this).parent().data("cb-prev"),C=e(this).parent().data("cb-next"),T=e(this).parent().parent(),R.addClass("cb-il-loading"),m=T.prev(),m.attr("data-cb-prev",v),m.attr("data-cb-next",C),e.get(k,function(a){w=e(a).find("#cb-main"),w.children().addClass("cb-slide-up-opa"),R.hasClass("cb-body-bs-2")?(w.find(".cb-m").removeClass("cb-m").addClass("cb-s"),w=w.children()):w=w.children(),e("#cb-main").append(w),"undefined"!=typeof De&&null!==De&&De.push(["_trackPageview",k]),new ScrollMagic.Scene({triggerElement:m,triggerHook:"onLeave"}).addTo(Ae).on("enter leave",function(a){"leave"===a.type?window.history.pushState("","",e("#"+this.triggerElement().id).data("cb-prev")):window.history.pushState("","",e("#"+this.triggerElement().id).data("cb-next"))}),R.removeClass("cb-il-loading"),Pe=!1,T.remove()}))}),$.click(function(e){e.preventDefault(),R.addClass("cb-m-modal-on")}),ee.click(function(e){e.preventDefault(),R.addClass("cb-sub-modal-on")}),Z.click(function(e){e.preventDefault(),R.addClass("cb-s-modal-on"),B===!1&&setTimeout(function(){se.focus()},50)}),he.length&&he.find(".sub-menu").prepend('<li class="cb-menu-back"><a href="#"><i class="fa fa-arrow-left"></i></a></li>'),L.on("click",".menu-item-has-children > a",function(a){a.preventDefault(),P=e(this),D=P.parent(),D.addClass("cb-selected"),je+=100,ge.css({"-webkit-transform":"translate3d(-"+je+"%, -50%, 0)",transform:"translate3d(-"+je+"%, -50%, 0)"})}),L.on("click",".cb-menu-back",function(a){a.preventDefault(),P=e(this),D=P.parent().parent(),D.removeClass("cb-selected"),je-=100,ge.css({"-webkit-transform":"translate3d(-"+je+"%, -50%, 0)",transform:"translate3d(-"+je+"%, -50%, 0)"})}),se.keyup(function(a){ie&&clearTimeout(ie),27==a.keyCode?(d(),b()):e.inArray(a.keyCode,ae)==-1&&(ie=setTimeout(r,300))}),L.keyup(function(e){27==e.keyCode&&(d(),b(),g(),f())}),K.click(function(){d(),b(),g(),f(),u()}),q.add(J).click(function(e){e.preventDefault()}),H.click(function(e){e.preventDefault(),Q.animate({scrollTop:0},1500)}),le.click(function(a){a.preventDefault(),R.addClass("cb-pf-modal-on"),e("#cb-media-trigger-"+ne).addClass("cb-active"),p()}),R.hasClass("cb-fw-embeds")&&me.each(function(){h(e(this))}),L.ready(function(e){if(t(),Ce.length&&(y=Ce.offset().top),pe.length){a=pe.offset().top,j=pe.height(),E=2*U+j;var a=pe.offset().top}ce.slick({variableWidth:!0,centerMode:!0,prevArrow:'<i class="fa cb-slider-arrow cb-slider-arrow-p fa-angle-left"></i>',nextArrow:'<i class="fa cb-slider-arrow cb-slider-arrow-n fa-angle-right"></i>'}),ce.on("swipe",function(e,a,t,s){R.addClass("cb-arrows-hover")}),Y=ce.find(".cb-slider-arrow"),Y.on({mouseenter:function(){R.addClass("cb-arrows-hover")},mouseleave:function(){R.removeClass("cb-arrows-hover")}}),ce.length&&pe.click(function(e){R.removeClass("cb-arrows-hover")}),F>767&&(be.tooltip({direction:"bottom"}),X===!1?fe.tooltip({direction:"right"}):fe.tooltip({direction:"left"})),L.ajaxStop(function(){e(".cb-loading").removeClass("cb-loading")}),Q.on("mousewheel DOMMouseScroll",function(){Q.stop()}),pe.find("a").has("img").each(function(){var a=e("img",this).attr("title"),t=e(this).attr("href"),s=e(this).data("rel");if("undefined"!=typeof a&&e(this).attr("title",a),"undefined"!=typeof t&&"prettyPhoto[product-gallery]"!==s){var o=t.split("."),i=e(o)[e(o).length-1];"jpg"!==i&&"jpeg"!==i&&"png"!==i&&"gif"!==i&&"tif"!==i||e(this).addClass("cb-lightbox")}}),e(".tiled-gallery, .gallery").find("a").attr("data-lightbox-gallery","tiledGallery"),e.prototype.lightbox&&e(".cb-lightbox").lightbox({fixed:!0})}),z.load(function(){ce.find(".slick-track").children().addClass("cb-slider-ldd").removeClass("cb-slider-hidden")}),z.resize(function(){U=z.height()+1,F=z.width(),N=G.outerHeight(),pe.length&&(M=pe.offset().top),F<767&&(de.css({top:""}).removeAttr("style"),re.css({top:""}).removeAttr("style")),ye.length&&(we.hasClass("cb-style-1")?(ye.css("height",U-N),we.css("height",U),R.hasClass("page")&&we.css("max-height",N+parseFloat(we.css("max-height"))+"px")):we.hasClass("cb-style-2")&&ye.css("height",Math.round((U-N)/1.4))),me.each(function(){h(e(this))})});var Ye=e("#cb-yt-player-"+ne)}(jQuery);var cbYTPlayerHolder,cbEmbedIconData=jQuery("#cb-embed-icon-trigger").data("cb-pid"),CbYTPlayer=jQuery("#cb-yt-player-"+cbEmbedIconData),cbYouTubeVideoID=CbYTPlayer.text();if(CbYTPlayer.length>0){var tag=document.createElement("script");tag.src="//www.youtube.com/iframe_api";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag)}